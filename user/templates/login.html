<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
</head>
<h1>Login</h1>
{% if error %}
  <p style="color:red;">{{ error }}</p>
{% endif %}
<form method="post">
  {% csrf_token %}
  <label>Email:</label><br>
  <input type="email" name="email" required><br><br>

  <label>Password:</label><br>
  <input type="password" name="password" required><br><br>

  <label>Captcha:</label><br>
  <img id="captchaImg" width="200" height="100" style="cursor:pointer;" onclick="refreshCaptcha()">
  <input type="text" name="captcha" required><br><br>

  <button type="submit">Login</button>
</form>

<script>
  const img = document.getElementById("captchaImg");
  function refreshCaptcha() {
    const ts = Date.now();
    img.src = "{% url 'api:get_captcha' %}?t=" + ts;
  }
  document.addEventListener("DOMContentLoaded", refreshCaptcha);
</script>
